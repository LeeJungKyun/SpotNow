Index: app/src/main/java/com/example/spotnow/participantFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.spotnow;\n\nimport android.app.Dialog;\nimport android.content.Intent;\nimport android.os.Bundle;\nimport android.view.View;\nimport android.widget.Button;\nimport android.widget.EditText;\nimport android.widget.ImageView;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport androidx.annotation.NonNull;\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport com.bumptech.glide.Glide;\nimport com.example.spotnow.ActivityInfo;\nimport com.example.spotnow.R;\nimport com.google.firebase.database.DataSnapshot;\nimport com.google.firebase.database.DatabaseError;\nimport com.google.firebase.database.DatabaseReference;\nimport com.google.firebase.database.FirebaseDatabase;\nimport com.google.firebase.database.ValueEventListener;\n\npublic class participantFragment extends AppCompatActivity {\n\n    private Dialog participantDialog;\n    private EditText comment;\n    private Button writeParticipateInfoButton;\n    private Button writeReportButton;\n    private Button writeCommentButton;\n    private ImageView activityImageView;\n    private TextView titleTextView;\n    private TextView contentTextView;\n\n    private DatabaseReference mDatabase;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.participant_activity_main);\n\n        writeParticipateInfoButton = findViewById(R.id.writeParticipateInfo);\n        writeReportButton = findViewById(R.id.writeReport);\n        writeCommentButton = findViewById(R.id.writeComment);\n        comment = findViewById(R.id.comment);\n        activityImageView = findViewById(R.id.place_holder_image);\n        titleTextView = findViewById(R.id.title);\n        contentTextView = findViewById(R.id.bottom_text_view);\n\n        // 인텐트에서 데이터 받아오기\n        Intent intent = getIntent();\n        if (intent != null) {\n            String activityTitle = intent.getStringExtra(\"activityTitle\");\n            String activityContent = intent.getStringExtra(\"activityContent\");\n\n            titleTextView.setText(activityTitle);\n            contentTextView.setText(activityContent);\n\n            // Firebase에서 데이터 가져오기\n            mDatabase = FirebaseDatabase.getInstance().getReference(\"activities\");\n            mDatabase.orderByChild(\"title\").equalTo(activityTitle).addListenerForSingleValueEvent(new ValueEventListener() {\n                @Override\n                public void onDataChange(@NonNull DataSnapshot dataSnapshot) {\n                    for (DataSnapshot snapshot : dataSnapshot.getChildren()) {\n                        ActivityInfo activity = snapshot.getValue(ActivityInfo.class);\n                        if (activity != null && activity.getContent().equals(activityContent)) {\n                            // 원하는 데이터를 찾았을 경우\n                            String activityId = snapshot.getKey();\n                            String imageUrl = activity.getImageUrl();\n\n                            Glide.with(participantFragment.this).load(imageUrl).into(activityImageView);\n\n                            Toast.makeText(participantFragment.this, \"Activity ID: \" + activityId, Toast.LENGTH_SHORT).show();\n                            Toast.makeText(participantFragment.this, \"Activity Title: \" + activity.getTitle(), Toast.LENGTH_SHORT).show();\n                            Toast.makeText(participantFragment.this, \"Activity Content: \" + activity.getContent(), Toast.LENGTH_SHORT).show();\n                            break;\n                        }\n                    }\n                }\n\n                @Override\n                public void onCancelled(@NonNull DatabaseError error) {\n                    // 실패했으\n                    Toast.makeText(participantFragment.this, \"Failed to read value.\", Toast.LENGTH_SHORT).show();\n                }\n            });\n        }\n\n        writeParticipateInfoButton.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                showParticipantDialog();\n            }\n        });\n\n        writeReportButton.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                reporting();\n            }\n        });\n\n        writeCommentButton.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                sendComment();\n            }\n        });\n    }\n\n    private void showParticipantDialog() {\n        participantDialog = new Dialog(this);\n        participantDialog.setContentView(R.layout.participant_dialog);\n\n        participantDialog.show();\n    }\n\n    private void reporting() {\n        participantDialog = new Dialog(this);\n        participantDialog.setContentView(R.layout.report);\n\n        participantDialog.show();\n    }\n\n    private void sendComment() {\n        String c = comment.getText().toString();\n\n        // 여기서 c를 가져와서 DB에 저장한 뒤 댓글 창에 보여주기\n        Toast.makeText(this, c, Toast.LENGTH_SHORT).show();\n\n        comment.setText(\"\");\n    }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/spotnow/participantFragment.java b/app/src/main/java/com/example/spotnow/participantFragment.java
--- a/app/src/main/java/com/example/spotnow/participantFragment.java	(revision bb9da7bbcd1b02716fc6e4c795c40d496fedc2dc)
+++ b/app/src/main/java/com/example/spotnow/participantFragment.java	(date 1684810849381)
@@ -125,7 +125,9 @@
 
     private void sendComment() {
         String c = comment.getText().toString();
-
+        //firebase
+        // activity id를 찾아서
+        // user id 와 comment를 (id, comment) firebase에 저장
         // 여기서 c를 가져와서 DB에 저장한 뒤 댓글 창에 보여주기
         Toast.makeText(this, c, Toast.LENGTH_SHORT).show();
 
Index: app/src/main/java/com/example/spotnow/ownerActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.spotnow;\n\nimport android.annotation.SuppressLint;\nimport android.app.Dialog;\nimport android.content.Intent;\nimport android.net.ParseException;\nimport android.net.Uri;\nimport android.os.Bundle;\nimport android.provider.MediaStore;\nimport android.util.Log;\nimport android.view.View;\nimport android.widget.AdapterView;\nimport android.widget.ArrayAdapter;\nimport android.widget.Button;\nimport android.widget.EditText;\nimport android.widget.ImageView;\nimport android.widget.Spinner;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport androidx.annotation.NonNull;\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport com.example.spotnow.common.FirebaseManager;\nimport com.google.android.gms.tasks.OnCompleteListener;\nimport com.google.android.gms.tasks.OnFailureListener;\nimport com.google.android.gms.tasks.OnSuccessListener;\nimport com.google.android.gms.tasks.Task;\nimport com.google.firebase.auth.FirebaseAuth;\nimport com.google.firebase.auth.FirebaseUser;\nimport com.google.firebase.database.DataSnapshot;\nimport com.google.firebase.database.DatabaseReference;\nimport com.google.firebase.database.FirebaseDatabase;\nimport com.google.firebase.storage.FirebaseStorage;\nimport com.google.firebase.storage.StorageReference;\nimport com.google.firebase.storage.UploadTask;\n\nimport java.text.BreakIterator;\nimport java.text.SimpleDateFormat;\nimport java.util.ArrayList;\nimport java.util.Date;\nimport java.util.UUID;\n\npublic class ownerActivity extends AppCompatActivity {\n\n    private Dialog deleteCheckDialog;\n    private EditText Comment;\n    private Button readParticipantListButton;\n    private Button deleteActivityButton;\n    private Button modifyActivityButton;\n    private Button writeCommentButton;\n    private ImageView placeHolderImage;\n    private Spinner activityTypeSpinner;\n    private Spinner monthSpinner;\n    private Spinner daySpinner;\n    private Spinner hourSpinner;\n    private Spinner minuteSpinner;\n    private Spinner endMonthSpinner; // 추가된 부분\n    private Spinner endDaySpinner; // 추가된 부분\n    private Spinner endHourSpinner; // 추가된 부분\n    private Spinner endMinuteSpinner; // 추가된 부분\n\n    private EditText participantCountEditText;\n    private EditText contentEditText;\n    private EditText title;\n\n    private TextView textView;\n\n    private DatabaseReference mDatabase;\n    private StorageReference mStorage;\n\n    private static final int PICK_IMAGE_REQUEST = 1;\n    private Uri selectedImageUri; // 선택된 이미지의 Uri를 저장하는 변수\n    private String activityOwner;\n\n    private FirebaseAuth mAuth;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.owner_activtiy_main);\n\n        textView = findViewById(R.id.text_view);\n        readParticipantListButton = findViewById(R.id.readParticipantList);\n        deleteActivityButton = findViewById(R.id.deleteActivity);\n        modifyActivityButton = findViewById(R.id.modifyActivity);\n        writeCommentButton = findViewById(R.id.writeComment);\n        Comment = findViewById(R.id.comment);\n        placeHolderImage = findViewById(R.id.place_holder_image);\n        activityTypeSpinner = findViewById(R.id.sport_spinner);\n        monthSpinner = findViewById(R.id.month_spinner);\n        daySpinner = findViewById(R.id.day_spinner);\n        hourSpinner = findViewById(R.id.hour_spinner);\n        minuteSpinner = findViewById(R.id.minute_spinner);\n        endMonthSpinner = findViewById(R.id.end_month_spinner); // 추가된 부분\n        endDaySpinner = findViewById(R.id.end_day_spinner); // 추가된 부분\n        endHourSpinner = findViewById(R.id.end_hour_spinner); // 추가된 부분\n        endMinuteSpinner = findViewById(R.id.end_minute_spinner); // 추가된 부분\n        participantCountEditText = findViewById(R.id.participant_count_edit_text);\n        contentEditText = findViewById(R.id.content_edit_text);\n        title = findViewById(R.id.title);\n\n        mStorage = FirebaseStorage.getInstance().getReference();\n\n        readParticipantListButton.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                callParticipantList();\n            }\n        });\n\n        writeCommentButton.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                sendComment();\n            }\n        });\n\n        placeHolderImage.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                openImagePicker(); // 앨벤여는거 함수 밑에 있음\n            }\n        });\n\n        ArrayAdapter<CharSequence> activityAdapter = ArrayAdapter.createFromResource(this, R.array.activity_types, android.R.layout.simple_spinner_item);\n        activityAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n        activityTypeSpinner.setAdapter(activityAdapter);\n\n        ArrayAdapter<CharSequence> monthAdapter = ArrayAdapter.createFromResource(this, R.array.months, android.R.layout.simple_spinner_item);\n        monthAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n        monthSpinner.setAdapter(monthAdapter);\n\n        ArrayAdapter<CharSequence> dayAdapter = ArrayAdapter.createFromResource(this, R.array.days, android.R.layout.simple_spinner_item);\n        dayAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n        daySpinner.setAdapter(dayAdapter);\n\n        ArrayAdapter<CharSequence> hourAdapter = ArrayAdapter.createFromResource(this, R.array.hours, android.R.layout.simple_spinner_item);\n        hourAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n        hourSpinner.setAdapter(hourAdapter);\n\n        ArrayAdapter<CharSequence> minuteAdapter = ArrayAdapter.createFromResource(this, R.array.minutes, android.R.layout.simple_spinner_item);\n        minuteAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n        minuteSpinner.setAdapter(minuteAdapter);\n\n        // Initialize end time spinners\n        ArrayAdapter<CharSequence> endMonthAdapter = ArrayAdapter.createFromResource(this, R.array.months, android.R.layout.simple_spinner_item);\n        endMonthAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n        endMonthSpinner.setAdapter(endMonthAdapter);\n\n        ArrayAdapter<CharSequence> endDayAdapter = ArrayAdapter.createFromResource(this, R.array.days, android.R.layout.simple_spinner_item);\n        endDayAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n        endDaySpinner.setAdapter(endDayAdapter);\n\n        ArrayAdapter<CharSequence> endHourAdapter = ArrayAdapter.createFromResource(this, R.array.hours, android.R.layout.simple_spinner_item);\n        endHourAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n        endHourSpinner.setAdapter(endHourAdapter);\n\n        ArrayAdapter<CharSequence> endMinuteAdapter = ArrayAdapter.createFromResource(this, R.array.minutes, android.R.layout.simple_spinner_item);\n        endMinuteAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n        endMinuteSpinner.setAdapter(endMinuteAdapter);\n\n\n        mAuth = FirebaseAuth.getInstance();\n        FirebaseUser currentUser = mAuth.getCurrentUser(); // 현재 로그인 한 유저 정보 반환\n\n        final String uid = currentUser.getUid(); // 유저의 uid 저장\n\n        ArrayList<String> path = new ArrayList<>();\n        path.add(uid);\n        path.add(\"name\");\n        FirebaseManager.GetReferencePath(\"users\", path).get().addOnCompleteListener(new OnCompleteListener<DataSnapshot>() {\n        @Override\n        public void onComplete(@NonNull Task<DataSnapshot> task) {\n            if (!task.isSuccessful()) {\n                Log.e(\"firebase\", \"Error getting data\", task.getException());\n            }\n            else {\n                Log.d(\"firebase\", String.valueOf(task.getResult().getValue()));\n                activityOwner=String.valueOf(task.getResult().getValue());\n            }\n        }\n    });\n\n\n//        mDatabase = FirebaseDatabase.getInstance().getReference();\n//        mDatabase.child(\"users\").child(uid).get().addOnCompleteListener(new OnCompleteListener<DataSnapshot>() {\n//            @Override\n//            public void onComplete(@NonNull Task<DataSnapshot> task) {\n//                if (!task.isSuccessful()) {\n//                    Log.e(\"firebase\", \"Error getting data\", task.getException());\n//                }\n//                else {\n//                    userInfo = task.getResult().getValue(UserInfo.class); // 유저 정보 한번 불러오기\n//\n//\n//                }\n//            }\n//        });\n\n\n        modifyActivityButton.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View view) {uploadActivity();}\n        });\n\n    }\n\n    private void callParticipantList() {\n        // 대기 목록 호출\n        // 이부분은 아마 등록하는 부분에서는 지워도 될듯 혹시 몰라 남겨놓음\n    }\n\n    public void uploadActivity(){\n        String TiTle = title.getText().toString();\n        String sport = activityTypeSpinner.getSelectedItem().toString();\n\n        String month = monthSpinner.getSelectedItem().toString();\n        String day = daySpinner.getSelectedItem().toString();\n        String hour = hourSpinner.getSelectedItem().toString();\n        String minute = minuteSpinner.getSelectedItem().toString();\n        String startTime = month + \"-\" + day + \"-\" + hour + \":\" + minute;\n\n        String endMonth = endMonthSpinner.getSelectedItem().toString(); // 추가된 부분\n        String endDay = endDaySpinner.getSelectedItem().toString(); // 추가된 부분\n        String endHour = endHourSpinner.getSelectedItem().toString(); // 추가된 부분\n        String endMinute = endMinuteSpinner.getSelectedItem().toString(); // 추가된 부분\n        String endTime = endMonth + \"-\" + endDay + \"-\" + endHour + \":\" + endMinute; // 추가된 부분\n\n        String participantCount = participantCountEditText.getText().toString();\n        String content = contentEditText.getText().toString();\n\n        // 전체값 팔수 입력\n        if (TiTle.isEmpty() || sport.equals(\"*선택*\") || startTime.isEmpty() || endTime.isEmpty() || participantCount.isEmpty() || content.isEmpty()) {\n            Toast.makeText(ownerActivity.this, \"모든 항목을 입력해주세요.\", Toast.LENGTH_SHORT).show();\n            return;\n        }\n\n                /* 날짜 형식 확인\n                SimpleDateFormat sdf = new SimpleDateFormat(\"yyyy-MM-dd-HH:mm\");\n                sdf.setLenient(false);\n                try {\n                    sdf.parse(startTime);\n                    sdf.parse(endTime);\n                } catch (ParseException e) {\n                    Toast.makeText(ownerActivity.this, \"날짜 형식이 잘못되었습니다. 올바른 형식은 'YYYY-MM-DD-HH:MM'입니다.\", Toast.LENGTH_SHORT).show();\n                    return;\n                } catch (java.text.ParseException e) {\n                    throw new RuntimeException(e);\n                }\n                */\n\n        // HomeFragment로부터 spotID를 받아옴\n        Intent getIntent = getIntent();\n        long spotID = getIntent.getLongExtra(\"spotID\", 0);\n        String spotAddress = getIntent.getStringExtra(\"spotAddress\");\n\n        // 이미지 업로드 후 액티비티 저장\n        uploadImageAndCreateActivity(TiTle, sport, startTime, endTime, participantCount, content, spotID,activityOwner);\n\n        finish();\n    }\n\n    private void sendComment() {\n        String comment = Comment.getText().toString();\n\n        Toast.makeText(getApplicationContext(), comment, Toast.LENGTH_SHORT).show();\n\n        Comment.setText(\"\");\n    }\n\n    private void openImagePicker() {\n        Intent intent = new Intent(Intent.ACTION_PICK, MediaStore.Images.Media.EXTERNAL_CONTENT_URI);\n        startActivityForResult(intent, PICK_IMAGE_REQUEST);\n    }\n\n    @Override\n    protected void onActivityResult(int requestCode, int resultCode, Intent data) {\n        super.onActivityResult(requestCode, resultCode, data);\n\n        if (requestCode == PICK_IMAGE_REQUEST && resultCode == RESULT_OK && data != null) {\n            selectedImageUri = data.getData();\n            placeHolderImage.setImageURI(selectedImageUri);\n            textView.setVisibility(View.GONE); // 이미지가 선택되면 TextView를 숨김\n        } else {\n            textView.setVisibility(View.VISIBLE); // 이미지가 선택되지 않으면 TextView를 보이게 함\n        }\n    }\n\n    private void uploadImageAndCreateActivity(String title, String sport, String startTime, String endTime, String peopleCnt, String content, long spotID,String activityOwner) {\n        if (selectedImageUri != null) {\n            StorageReference imageRef = mStorage.child(\"images/\" + UUID.randomUUID().toString());\n\n            imageRef.putFile(selectedImageUri)\n                    .addOnSuccessListener(new OnSuccessListener<UploadTask.TaskSnapshot>() {\n                        @Override\n                        public void onSuccess(UploadTask.TaskSnapshot taskSnapshot) {\n                            // 이미지 업로드 성공\n                            imageRef.getDownloadUrl().addOnSuccessListener(new OnSuccessListener<Uri>() {\n                                @Override\n                                public void onSuccess(Uri uri) {\n                                    // 이미지의 다운로드 URL을 가져옴\n                                    String imageUrl = uri.toString();\n\n                                    // 액티비티 정보와 이미지 URL을 함께 저장\n                                    createActivity(title, sport, startTime, endTime, peopleCnt, content, spotID, imageUrl,activityOwner);\n                                }\n                            }).addOnFailureListener(new OnFailureListener() {\n                                @Override\n                                public void onFailure(@NonNull Exception e) {\n                                    // 이미지의 다운로드 URL을 가져오는데 실패\n                                    Toast.makeText(ownerActivity.this, \"이미지 업로드에 실패하였습니다.(DownloadERROR)\", Toast.LENGTH_SHORT).show();\n                                }\n                            });\n                        }\n                    })\n                    .addOnFailureListener(new OnFailureListener() {\n                        @Override\n                        public void onFailure(@NonNull Exception e) {\n                            // 이미지 업로드 실패\n                            Toast.makeText(ownerActivity.this, \"이미지 업로드에 실패하였습니다.(UPLOADERROR)\", Toast.LENGTH_SHORT).show();\n                        }\n                    });\n        } else {\n            // 이미지가 선택되지 않았을 경우에도 액티비티 저장\n            createActivity(title, sport, startTime, endTime, peopleCnt, content, spotID, null,activityOwner);\n        }\n    }\n\n    private void createActivity(String title, String sport, String startTime, String endTime, String peopleCnt, String content, long spotID, String imageUrl,String activityOwner) {\n        mDatabase = FirebaseDatabase.getInstance().getReference();\n\n\n        ActivityInfo activity = new ActivityInfo(title, sport, content, startTime, endTime, peopleCnt, spotID, imageUrl, activityOwner);\n        Toast.makeText(getApplicationContext(), activity.spotID + activity.title, Toast.LENGTH_SHORT).show();\n        mDatabase.child(\"activities\").push().setValue(activity);\n    }\n\n\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/spotnow/ownerActivity.java b/app/src/main/java/com/example/spotnow/ownerActivity.java
--- a/app/src/main/java/com/example/spotnow/ownerActivity.java	(revision bb9da7bbcd1b02716fc6e4c795c40d496fedc2dc)
+++ b/app/src/main/java/com/example/spotnow/ownerActivity.java	(date 1684810849354)
@@ -263,7 +263,9 @@
 
     private void sendComment() {
         String comment = Comment.getText().toString();
-
+        //firebase
+        // activity id를 찾아서
+        // user id 와 comment를 (id, comment) firebase에 저장
         Toast.makeText(getApplicationContext(), comment, Toast.LENGTH_SHORT).show();
 
         Comment.setText("");
